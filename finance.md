# Notes on Quantitative Finance


## General

In finance, when we look at an investable asset we are interested in two pieces of data: its mean past returns, its volatility and its expected returns. 

Why is the volatility important? People accumulate and invest their wealth in order to increase their future consumption, but there is uncertainity in when and how much they will need. An asset with high mean returns but also high volatility makes harder to forecast future wealth, so it brings additional uncertainity to the table. 

But it is also true that if we want to have a higher chance of maximing wealth growth, we do need high mean return. But mean returns aren't expected returns. 

So fundamentally, optimizing investing is trying to find assets where the mean returns are high enough to justify the volatility of an asset.

This is why it makes sense to build a portfolio of different uncorrelated assets, as the mean returns are summed while the volatility of the returns of the entire portfolio is reduced.

## Volatility 

The price over time of any tradable asset can be describe by a timeseries of prices $S_{n}$, which we assume discrete.  This timeserie is extracted by sampling the trade by trade history of the asset with a constant frequency. The most common frequency for analyzing returns and volatility is daily, but higher frequency data such as hourly prices or even minute by minute can be used. 

### Log Returns

The return between two consecutive periods in the timeseries is simply $ r_i = \frac{S_i - S_{i-1}}{S_{i-1}}$. Often, we are interested in the cumulative or compound return of an asset between two timestep $ T_1 $ and $T_2 $, so we find that:

```{math}
:label: compound
```
$$
r_{T_2} = \prod_{i=T_1}^{T_2} r_i
$$
If either the periods or the returns between periods are small, we can find a more convenient way to define returns: the log returns.
$$
x_i = \ln\left(\frac{S_i}{S_{i-1}}\right)
$$
so that the compound returns between two timestep  $ T_1 $,  $T_2 $ of the timeseries is:
$$
x_{T_2} = \sum_{i=T_1}^{T_2} x_i
$$
This approximation is valid because:
$$
x_i = \ln\left(\frac{S_i}{S_{i-1}}\right) = \ln \left( \frac{S_{i-1} + \delta}{S_{i-1}} \right) = \ln \left( 1 + \frac{\delta}{S_{i-1}}\right) \approx \left( \frac{\delta}{S_{i-1}}\right) = \left(\frac{S_{i-1} + \delta - S_{i-1} }{S_{i-1}}\right) = \left(\frac{S_{i} - S_{i-1} }{S_{i-1}}\right)
$$
thanks to the log approximation $\ln(1+x) \approx x $ for $x \ll 1$.  

### The Normal Distribution of Log Returns 

If we plot the distribution of the log returns in a time period $[T1, T2]$, with enough timesteps in between, we find that the distribution more or less resembles a normal distribution. Often, in finance, pricing models use as theoretical assumption that returns are log-normal, although it is well known that it isn't true in practise: if we plot those distribution we will see that they often present high skew and high kurtosis, i.e they have fat tails of outliers. But the log normal assumption allows to make models either computable or solvable analitically, and we can then use other tools to reduce the impact of the log normal assumption. 


### Variance and Volatility

As we have now an empirical defined distribution of log returns, we can talk about the mean $ E[x]$, which is the first moment of the distribution, and the variance $E[x^2]$,  its second moment. 

The volatility of returns $ \sigma $ is defined as the square root of the variance of the log return distribution. Since the distribution can be approximated to a normal one, the volatility is simple the standard deviation. 

\begin{gather}
\sigma^2 = \frac{1}{N} \sum_{i=1}^N \left(x_i - \bar x \right)^2
x_i = \ln\left(\frac{S_i}{S_{i-1}}\right) 
\bar x = \frac{1}{N} \sum_{i=1}^N x_i $ 
\end{gather}

### Square Root of Time Rule

For convience, both mean returns and volatility are reported annualized. How do we annualize them?

Once again, we use the log approximation of returns so that we can say that the compound returns between two timestep is the sum of the returns in between. Assuming that those returns are all generated by indipendent identical processes, we can then approximate the mean $\mu$ and variance $\sigma^2$ as the sum of the $\mu_i$ and $\sigma^2_i$, and finally approximate it as simply 

Mean: $\mu = \mu_1 h$ 

Variance: $\sigma^2 = \sigma^2_1 h$

Volatility: $\sigma = \sigma_1 \sqrt h $

where $h$ is the number of periods of our timeserie in a trading year {cite}`option_trading`. 

  We cannot distinguish from the volatility generated from variation around the mean and the mean return or drift itself, and the mean return is noisy and depends from the sample. Since we are more interested in the former than the latter, we can set $ \bar x = 0 $.  

Already from this definition, we can see that the volatility has a few assumption: 

* What is the sampling period of the prices in the discrete timeseries with the respect to the actual price history?
* What type of pricing data are we considering? The high, low of a trading period? The open? The close?
* Do we have enough periods in our sample so that the distribution can be approximated to a normal one?

The definition giving above is therefore not the real volatility of returns of the asset, which cannot be known, but a statistical estimator of the volatility. It is also an historical estimator, it can give us information of the past volatility but it can be dangerous to quickly estrapolate that estimate to future volatility. 

Ideally, we want our estimator to be unbiased and efficient. In statistics, bias is defined as the difference between an estimator expected value and the true value of the parameter being estimated.  We also want an estimator that is stable from sample to sample: the less prone to sampling error an estimator is, the more efficient it is.

The estimator presented in the definition above is applied to timeseries of closing prices and therefore it is called the **close-on-close estimator** of volatility. It converges slowly in N to the true value of the volatility, so that we need a series of >30 prices to have an estimate of volatility with a decent uncertainity.  

and we find that the variance in the sample is

\begin{align*}
s^2 = \frac{1}{N} \sum_{i=1}^N x_i^2
\end{align*}

To move from the sample variance to the population variance: 

\begin{align*}
\sigma^2 = \frac{N}{N - 1} s^2
\end{align*}

Sample to population? What does it means? Why? 

```{bibliography}

```
